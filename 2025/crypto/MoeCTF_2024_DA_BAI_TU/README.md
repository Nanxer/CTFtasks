## MoeCTF_2024_DA_BAI_TU

### description:

大白兔大白兔，你是谁？

### analysis:

`c=pow((a*p+b*q),t,N)`， 二项式展开结合`N=p*q`，所以再mod N的情况下`c=(a*p)^t+(b*q)^t mod N`,因为其他项都含有`p*q`在`mod N`后都0。

结合c1与c2消去一个p(或q)，可以得到 `q^(e1*e2) mod N`的值，即`q^(e1*e2)+k*N=q^(e1*e2)+k*p*q=q*(q^(e1*e2-1)+k*p)`

并且`q^(e1*e2-1)+k*p`不含有p或者q的因子=>`GCD(q^(e1*e2) mod N,N)=q`,那么p和q都可以得到

### exp:

```python
from Crypto.Util.number import *
e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697
e = 65537
N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267
c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045
c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474
c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050
ce=pow(2,e1*e2,N)*pow(c1,e2,N)-pow(3,e1*e2,N)*pow(c2,e1,N)
p=GCD(ce,N)
q=N//p
assert p*q==N
d=inverse(e,(p-1)*(q-1))
print(long_to_bytes(pow(c,d,N)))
#b'moectf{Sh4!!0w_deeb4t0_P01arnova}'
```

### attach:

None
