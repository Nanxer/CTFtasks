#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from Crypto.Util.number import *
from secret import flag

flag = bytes(flag, 'utf-8')
m = bytes_to_long(flag)

e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697


def encrypt(m, e1, e2):
    p = getPrime(512)
    q = getPrime(512)
    N = p * q
    c1 = pow((3 * p + 7 * q), e1, N)
    c2 = pow((2 * p + 5 * q), e2, N)
    e = 65537
    c = pow(m, e, N)
    print(f'N = {N}\nc1 = {c1}\nc2 = {c2}\nc = {c}')


encrypt(m, e1, e2)

'''
N = 148907575238466010204384519686614604820913699346037297175778162799792086226730585402286006363904823816138216702220485330237879392639130675438350875277747318765161171260499682694702967633732815974259187003101922796812584409447057824997487085283886460774676570730674063909442684691164008543843241314773114815091
c1 = 121282053659349335680911669723698786156159150741660358234452220347922536166165372546498306584063942902402397364580840865416599825960169994302747260795468935361230966755292858863976557696110626193920081775487545479989192594218849838482189833596485213023342316975193897347298123510901197053346354631641597939551
c2 = 138866653307513244702882069432357580529750142557945327987868509753232321552391026523860003108170864840077564979534202253235018630353886340534689633792058026166924686631005715155506707781158436159053102240789605207071075427448691653306566397666596913975516703019720193463149209844469287913992941121083662691634
c = 8851824812785907960515811687107874617865892810069100608291132344387282107873918678327821053867382369320045945626492730550114598857554689000993081239375906513953426759604422313190588538121473300425114106647702279386516340113406039384614619221180361023548802283885630994538117185521671645902473172248780555646
'''
