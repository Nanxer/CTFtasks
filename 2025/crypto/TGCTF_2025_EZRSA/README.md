## TGCTF_2025_EZRSA

### description:

EZRSAğŸ¤¡ğŸ’˜

### analysis:

pä½ä½æ³„éœ²ï¼Œä½¿ç”¨coppersmith

e,phiä¸äº’ç´ ï¼Œæœ‰é™åŸŸå¼€æ–¹ï¼Œcrt

### exp:

```python
# print(224//32*32)           # 224
# print(512//8//4-224//32)    # 9
# pçš„é«˜ä½ä¸º224ä½01ä¸²ï¼Œä½ä½ä½9ä¸ªemoji
# print(512//8//4)            # 16
# qä½16ä¸ªemoji

# for a in 'ğŸ˜˜ğŸ˜¾ğŸ˜‚ğŸ˜‹ğŸ˜¶ğŸ˜¾ğŸ˜³ğŸ˜·': # å…±æœ‰9ä¸ªemojiï¼Œè¿™é‡Œç»™å‡ºä½8ä¸ª
#     print(bytes_to_long(a.encode()),end=' ') # 4036991128 4036991166 4036991106 4036991115 4036991158 4036991166 4036991155 4036991159
# print(len(bin(4036991128).replace('0b',''))) # 32ä½

# from Crypto.Util.number import *
# print(bytes_to_long('ğŸ˜˜ğŸ˜¾ğŸ˜‚ğŸ˜‹ğŸ˜¶ğŸ˜¾ğŸ˜³ğŸ˜·'.encode())) # P0_=108837065531980906150333850570890620719343963272506332719822248235755953428663


"""
# sage
from Crypto.Util.number import *

p0_=108837065531980906150333850570890620719343963272506332719822248235755953428663
n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579
p1_ = 4036991100

P.<x> = PolynomialRing(Zmod(n))

for k in range(100):
    print(f'k={k}')
    f = x*2^(32*9) + p0_ + (p1_+k)*2^(8*32)
    f = f.monic()
    roots=f.small_roots(X=2^225, beta=0.4, epsilon=0.04)

    if roots:
        x = roots[0]
        p_candidate = int(x*2^(32*9) + p0_ + (p1_+k)*2^(8*32))
        if n % p_candidate == 0:
            print("p = ",p_candidate)
            print("q = ",n//p_candidate)
            break
"""

from Crypto.Util.number import *

p =  12424840247075830662687097292458444573014198016321428995092662043898159667123240573630892907827505266982898641483333170032514244713840745287869771915696311
q =  12602471198163266643743702664647336358595911975665358584258749238146841559843060594842063473155049870396568542257767865369797827796765830093256146584311989
n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579
c = 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401
# e = bytes_to_long("ğŸ’¯".encode())
e = 4036989615

# print(GCD(e,(p-1)*(q-1)))   # 15
# print(GCD(e,(p-1)))         # 5
# print(GCD(e,(q-1)))         # 3
# e,phiä¸äº’ç´ ï¼Œä¸”eå’Œ(p-1)ã€(q-1)å‡ä¸äº’ç´ ï¼Œä½¿ç”¨æœ‰é™åŸŸå¼€æ–¹

d = inverse(e//GCD(e,(p-1)*(q-1)),(p-1)*(q-1))
c = pow(c,d,n)

"""
# sage
R.<y>=PolynomialRing(Zmod(p))
f=y^15-c
f=f.monic()
m1=f.roots()

R.<z>=PolynomialRing(Zmod(q))
f=z^15-c
f=f.monic()
m2=f.roots()

for i in m1:
    for j in m2:
        m=solve_crt([int(i[0]),int(j[0])],[int(p),int(q)])
        if b'TGCTF' in long_to_bytes(int(m)):
            print(long_to_bytes(int(m)).decode())
            # TGCTF{ğŸ™‡ğŸ®ğŸ¤Ÿ_ğŸ«¡ğŸ«¡ğŸ«¡_ğŸš©ğŸš©ğŸš©}ğŸ˜ƒğŸ˜–ğŸ˜˜ğŸ˜¨ğŸ˜¢
"""
# TGCTF{ğŸ™‡ğŸ®ğŸ¤Ÿ_ğŸ«¡ğŸ«¡ğŸ«¡_ğŸš©ğŸš©ğŸš©}
```

### attach:

None
