## TGCTF_2025_tRwSiAns

### description:

啊？x2

### analysis:

基础的相关消息攻击

e很小，$$(m+hash(x_1))^3-(m+hash(x_2))^3=c_1-c_2 \mod n$$，展开得到一元二次方程，由于m小于n，求得的方程解即为m

### exp:

```python
from Crypto.Util.number import *
from math import sqrt
import gmpy2

def solve(a,b,c):
    delta=b**2-4*a*c

    if delta<0:
        return None
    elif delta==0:
        x=(-b+sqrt(delta))/(2*a)
        return x
    else:
        x1=(-b+gmpy2.iroot(delta,2)[0])//(2*a)
        x2=(-b-gmpy2.iroot(delta,2)[0])//(2*a)
        return [x1,x2]

n = 100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839
e = 3
c1 = 41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366
c2 = 41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814

# import hashlib
# x1, x2 = 307, 7
# x11=int(hashlib.md5(str(x1).encode()).hexdigest(), 16)
# x22=int(hashlib.md5(str(x2).encode()).hexdigest(), 16)

x11=189543988020763859054201121867732572001
x22=190188081314515644627836686569786975555

a=3*(x11-x22)
b=3*(x11**2-x22**2)
c=x11**3-x22**3-c1+c2

x=solve(a,b,c)

print(long_to_bytes(x[1]))
# b'TGCTF{RS4_Tw1nZ_d0You_th1nk_ItS_fun_2win?!!!1111111111}'
```

### attach:

None
